<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Trading App</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f4f6fb; }
    .container { max-width: 400px; margin: 60px auto; background: #fff; padding: 32px 24px; border-radius: 8px; box-shadow: 0 2px 8px #0001; }
    h2 { text-align: center; margin-bottom: 24px; }
    .form-group { margin-bottom: 16px; }
    label { display: block; margin-bottom: 6px; }
    input[type="text"], input[type="password"] { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
    button { width: 100%; padding: 10px; background: #1976d2; color: #fff; border: none; border-radius: 4px; font-size: 16px; cursor: pointer; margin-bottom: 8px; }
    button:disabled { background: #90caf9; }
    .message { text-align: center; margin-top: 12px; color: #d32f2f; }
    .success { color: #388e3c; }
        .toggle-link { color: #1976d2; cursor: pointer; text-decoration: underline; font-size: 14px; display: block; text-align: center; margin-top: 8px; }
    </style>
 </head>
<body>
    <div class="container">
        <h2 id="form-title">Đăng nhập</h2>
        <form id="auth-form">
            <div class="form-group">
                <label for="username">Tên đăng nhập</label>
                <input type="text" id="username" name="username" required>
            </div>
            <div class="form-group">
                <label for="password">Mật khẩu</label>
                <input type="password" id="password" name="password" required>
            </div>
            <button type="submit" id="submit-btn">Đăng nhập</button>
        </form>
        <span class="toggle-link" id="toggle-link">Chưa có tài khoản? Đăng ký</span>
        <div class="message" id="message"></div>
    </div>
    <script>
    const form = document.getElementById('auth-form');
    const toggleLink = document.getElementById('toggle-link');
    const formTitle = document.getElementById('form-title');
    const submitBtn = document.getElementById('submit-btn');
    const messageDiv = document.getElementById('message');
    let isLogin = true;
        toggleLink.onclick = function() {
            isLogin = !isLogin;
            if (isLogin) {
                formTitle.textContent = 'Đăng nhập';
                submitBtn.textContent = 'Đăng nhập';
                toggleLink.textContent = 'Chưa có tài khoản? Đăng ký';
            } else {
                formTitle.textContent = 'Đăng ký';
                submitBtn.textContent = 'Đăng ký';
                toggleLink.textContent = 'Đã có tài khoản? Đăng nhập';
            }
            messageDiv.textContent = '';
    };

    form.onsubmit = async function(e) {
        e.preventDefault();
        messageDiv.textContent = '';
        submitBtn.disabled = true;
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        let url = isLogin ? '/api/v1/user/login' : '/api/v1/user/register';
        let method = isLogin ? 'POST' : 'PUT';
        let payload = { username, password };
        try {
            const res = await fetch(url, {
                method: method,
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            const data = await res.json();
            if (res.ok) {
                messageDiv.textContent = isLogin ? 'Đăng nhập thành công!' : 'Đăng ký thành công!';
                messageDiv.className = 'message success';
            } else {
                messageDiv.textContent = data.message || 'Có lỗi xảy ra!';
                messageDiv.className = 'message';
            }
        } catch (err) {
            messageDiv.textContent = 'Không thể kết nối server!';
            messageDiv.className = 'message';
        }
        submitBtn.disabled = false;
    };
    </script>
 </body>
 </html>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Auth</title>
</head>
<body>
<h1>Login</h1>
<form id="loginForm">
    <input type="text" id="loginUsername" placeholder="Username" required>
    <input type="password" id="loginPassword" placeholder="Password" required>
    <button type="submit">Login</button>
</form>

<h1>Register</h1>
<form id="registerForm">
    <input type="text" id="registerUsername" placeholder="Username" required>
    <input type="password" id="registerPassword" placeholder="Password" required>
    <input type="email" id="registerEmail" placeholder="Email" required>
    <input type="text" id="registerName" placeholder="Name" required>
    <button type="submit">Register</button>
</form>

<pre id="output"></pre>

<script>
const output = document.getElementById('output');

async function handleResponse(res) {
    const text = await res.text();
    output.textContent = text;
}

document.getElementById('loginForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const body = {
        username: document.getElementById('loginUsername').value,
        password: document.getElementById('loginPassword').value
    };
    const res = await fetch('/api/v1/user/login', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(body)
    });
    handleResponse(res);
});

document.getElementById('registerForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const body = {
        username: document.getElementById('registerUsername').value,
        password: document.getElementById('registerPassword').value,
        email: document.getElementById('registerEmail').value,
        name: document.getElementById('registerName').value,
        cmnd: '',
        birthday: 0,
        gender: false,
        permanentAddress: '',
        phoneNumber: ''
    };
    const res = await fetch('/api/v1/user/register', {
        method: 'PUT',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(body)
    });
    handleResponse(res);
});
</script>
</body>
</html>
